import pytest
import pandas as pd


@pytest.fixture
def raw_students_df():
    return pd.DataFrame(
        [
            {
                "StudentID": 357,
                "FirstName": "Miguel",
                "FamilyName": "Carias",
                "school": "MS",
                "sex": "F",
                "age": 17,
                "address": "U",
                "famsize": "LE3",
                "Pstatus": "A",
                "Medu": 3,
                "Fedu": 2,
                "Mjob": "services",
                "Fjob": "other",
                "reason": "reputation",
                "guardian": "mother",
                "traveltime": 2,
                "studytime": 2,
                "failures": 0,
                "schoolsup": "no",
                "famsup": "no",
                "paid": "no",
                "activities": "no",
                "nursery": "yes",
                "higher": "yes",
                "internet": "no",
                "romantic": "yes",
                "famrel": 1,
                "freetime": 2,
                "goout": 3,
                "Dalc": 1,
                "Walc": 2,
                "health": 5,
                "absences": 2,
                "FinalGrade": 11,
            },
            {
                "StudentID": 178,
                "FirstName": "Sofia",
                "FamilyName": "Porto",
                "school": "GP",
                "sex": "M",
                "age": 16,
                "address": "R",
                "famsize": "GT3",
                "Pstatus": "T",
                "Medu": 4,
                "Fedu": 2,
                "Mjob": "teacher",
                "Fjob": "services",
                "reason": "other",
                "guardian": "mother",
                "traveltime": 1,
                "studytime": 1,
                "failures": 0,
                "schoolsup": "no",
                "famsup": "yes",
                "paid": "no",
                "activities": "yes",
                "nursery": "yes",
                "higher": "yes",
                "internet": "yes",
                "romantic": "yes",
                "famrel": 4,
                "freetime": 3,
                "goout": 3,
                "Dalc": 3,
                "Walc": 4,
                "health": 3,
                "absences": 10,
                "FinalGrade": 9,
            },
            {
                "StudentID": 56,
                "FirstName": "Salvador",
                "FamilyName": "Peixoto",
                "school": "GP",
                "sex": "F",
                "age": 15,
                "address": "U",
                "famsize": "GT3",
                "Pstatus": "A",
                "Medu": 4,
                "Fedu": 3,
                "Mjob": "services",
                "Fjob": "services",
                "reason": "reputation",
                "guardian": "mother",
                "traveltime": 1,
                "studytime": 2,
                "failures": 0,
                "schoolsup": "no",
                "famsup": "yes",
                "paid": "yes",
                "activities": "yes",
                "nursery": "yes",
                "higher": "yes",
                "internet": "yes",
                "romantic": "no",
                "famrel": 4,
                "freetime": 3,
                "goout": 2,
                "Dalc": 1,
                "Walc": 1,
                "health": 1,
                "absences": 0,
                "FinalGrade": 15,
            },
        ]
    )


@pytest.fixture
def processed_students_df():
    return pd.DataFrame(
        [
            {
                "studentid": 357,
                "firstname": "Miguel",
                "familyname": "Carias",
                "school": "MS",
                "sex": "F",
                "age": 17,
                "address": "U",
                "famsize": "LE3",
                "pstatus": "A",
                "medu": 3,
                "fedu": 2,
                "mjob": "services",
                "fjob": "other",
                "reason": "reputation",
                "guardian": "mother",
                "traveltime": 2,
                "studytime": 2,
                "failures": 0,
                "schoolsup": "no",
                "famsup": "no",
                "paid": "no",
                "activities": "no",
                "nursery": "yes",
                "higher": "yes",
                "internet": "no",
                "romantic": "yes",
                "famrel": 1,
                "freetime": 2,
                "goout": 3,
                "dalc": 1,
                "walc": 2,
                "health": 5,
                "absences": 2,
                "finalgrade": 11,
                "success": "Yes",
                "accompanying_complexity": 18.0,
                "school_category": "Mousinho da Silveira",
                "sex_category": "Female",
                "address_category": "Urban",
                "medu_category": "Secondary education",
                "fedu_category": "5th to 9th grade",
                "studytime_category": "2 to 5 hours",
                "walc_category": "Low",
                "failures_category": "No",
            },
            {
                "studentid": 178,
                "firstname": "Sofia",
                "familyname": "Porto",
                "school": "GP",
                "sex": "M",
                "age": 16,
                "address": "R",
                "famsize": "GT3",
                "pstatus": "T",
                "medu": 4,
                "fedu": 2,
                "mjob": "teacher",
                "fjob": "services",
                "reason": "other",
                "guardian": "mother",
                "traveltime": 1,
                "studytime": 1,
                "failures": 0,
                "schoolsup": "no",
                "famsup": "yes",
                "paid": "no",
                "activities": "yes",
                "nursery": "yes",
                "higher": "yes",
                "internet": "yes",
                "romantic": "yes",
                "famrel": 4,
                "freetime": 3,
                "goout": 3,
                "dalc": 3,
                "walc": 4,
                "health": 3,
                "absences": 10,
                "finalgrade": 9,
                "success": "No",
                "accompanying_complexity": 100.0,
                "school_category": "Gabriel Pereira",
                "sex_category": "Male",
                "address_category": "Rural",
                "medu_category": "Higher education",
                "fedu_category": "5th to 9th grade",
                "studytime_category": "<2 hours",
                "walc_category": "High",
                "failures_category": "No",
            },
            {
                "studentid": 56,
                "firstname": "Salvador",
                "familyname": "Peixoto",
                "school": "GP",
                "sex": "F",
                "age": 15,
                "address": "U",
                "famsize": "GT3",
                "pstatus": "A",
                "medu": 4,
                "fedu": 3,
                "mjob": "services",
                "fjob": "services",
                "reason": "reputation",
                "guardian": "mother",
                "traveltime": 1,
                "studytime": 2,
                "failures": 0,
                "schoolsup": "no",
                "famsup": "yes",
                "paid": "yes",
                "activities": "yes",
                "nursery": "yes",
                "higher": "yes",
                "internet": "yes",
                "romantic": "no",
                "famrel": 4,
                "freetime": 3,
                "goout": 2,
                "dalc": 1,
                "walc": 1,
                "health": 1,
                "absences": 0,
                "finalgrade": 15,
                "success": "Yes",
                "accompanying_complexity": 0.0,
                "school_category": "Gabriel Pereira",
                "sex_category": "Female",
                "address_category": "Urban",
                "medu_category": "Higher education",
                "fedu_category": "Secondary education",
                "studytime_category": "2 to 5 hours",
                "walc_category": "Very low",
                "failures_category": "No",
            },
        ]
    )
